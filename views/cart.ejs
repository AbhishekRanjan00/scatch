<%- include('./partials/header') %>

<% user.cart.forEach(function(item){ %>
  <div class="w-full min-h-screen flex flex-col md:flex-row items-start px-5 md:px-20 py-10 gap-6">
    
    <!-- Product Card -->
    <div class="w-full md:w-[40%] rounded-md overflow-hidden">
      <div class="w-full h-80 flex justify-center items-center bg-[<%= item.bgcolor %>]">
        <img class="h-[18rem]" src="data:images/png;base64,<%= item.image.toString('base64') %>" alt="">
      </div>

      <div class="w-full flex justify-between px-5 py-4 bg-[<%= item.panelcolor %>]">
        <h3 class="text-xl md:text-2xl"><%= item.name %></h3>
        <div class="flex items-center gap-2">
          <i class="w-7 h-7 bg-white flex rounded-full items-center justify-center ri-add-line"></i>
          <div class="px-2 py-1 rounded-md bg-white text-black">01</div>
          <i class="w-7 h-7 bg-white flex rounded-full items-center justify-center ri-subtract-line"></i>
        </div>
      </div>

      <div class="flex items-center justify-between px-5 py-3 text-white bg-[<%= item.textcolor %>]">
        <h4 class="text-base md:text-lg">Net Total</h4>
        <h2 class="text-base md:text-lg">₹ <%= item.price - (item.discount || 0) %></h2>
      </div>

      <!-- Remove Button -->
      <div class="flex justify-center mt-4">
        <a href="/removefromcart/<%= item._id %>" class="px-4 py-2 bg-red-500 text-white rounded-md">
          Remove from Cart
        </a>
      </div>
    </div>

    <!-- Price Breakdown -->
    <div class="w-full md:w-[60%]">
      <h3 class="text-lg md:text-xl">Price Breakdown</h3>
      <div class="px-5 md:px-10 mt-5 text-sm md:text-base">
        <div class="flex mt-2 justify-between">
          <h4>Total MRP</h4>
          <h4>₹ <%= item.price %></h4>
        </div>
        <div class="flex mt-2 justify-between">
          <h4>Discount on MRP</h4>
          <h4>₹ <%= item.discount %></h4>
        </div>
        <div class="flex mt-2 justify-between">
          <h4>Platform Fee</h4>
          <h4>₹ 20</h4>
        </div>
        <div class="flex mt-2 justify-between">
          <h4>Shipping Fee</h4>
          <h4>FREE</h4>
        </div>
      </div>

      <div class="w-full h-[1px] bg-black mt-10"></div>

      <div class="flex justify-between mt-5 text-base md:text-xl">
        <h3>Total Amount</h3>
        <h3 class="font-semibold text-green-600">₹ <%= item.price - (item.discount || 0) %></h3>
      </div>
    </div>
  </div>
<% }) %>

<!-- Cart Summary (Fixed Bottom or Separate) -->
<div class="w-full flex justify-end px-5 md:pr-20 pb-20">
  <div class="w-full md:w-[40%] bg-gray-100 p-5 rounded-md">
    <h3 class="text-lg md:text-xl mb-4">Cart Summary</h3>
    <div class="flex justify-between mb-2">
      <span>Total (including ₹20 shipping)</span>
      <span class="text-green-600 font-semibold text-2xl md:text-4xl">₹ <%= bill %></span>
    </div>
  </div>
</div>

<%- include('./partials/footer') %>
